<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Form Visitasi PAUD</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      padding: 20px;
      max-width: 1000px;
      margin: auto;
    }
    label {
      display: block;
      margin-top: 10px;
      font-weight: bold;
    }
    input, textarea {
      width: 100%;
      padding: 10px;
      margin-bottom: 10px;
      border: 1px solid #ccc;
      border-radius: 5px;
    }
    button {
      padding: 10px 20px;
      background: #28a745;
      color: white;
      border: none;
      border-radius: 5px;
      font-size: 16px;
    }
    button:hover {
      background: #218838;
    }
    .komponen {
      margin-top: 30px;
      background: #f9f9f9;
      padding: 15px;
      border-radius: 8px;
      box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);
    }
    .checkbox-group label {
      display: block;
      font-weight: normal;
      margin-left: 15px;
    }
  </style>
</head>
<body>

<h2>Form Visitasi PAUD</h2>

<label>Nama Sekolah</label>
<input type="text" id="nama_sekolah" placeholder="Contoh: PAUD Ceria" required>

<label>NPSN</label>
<input type="text" id="npsn" placeholder="Contoh: 12345678" required>

<div id="formContainer"></div>

<button onclick="kirimData()">Kirim</button>

<script>
  const butirList = {
    "1.1": [
      "Guru menanamkan nilai keagamaan melalui dialog, dongeng, cerita, atau buku cerita",
      "Guru mengenalkan makhluk ciptaan Tuhan dan hasil karya manusia",
      "Guru memberi contoh perilaku baik terhadap manusia ciptaan Tuhan",
      "Guru memberi contoh perilaku baik terhadap makhluk ciptaan Tuhan"
    ],
    "1.2": [
      "Guru menstimulasi anak mengucapkan doa",
      "Guru menstimulasi anak mengucapkan salam",
      "Guru menstimulasi praktik ibadah",
      "Guru mengenalkan tempat ibadah"
    ],
    "1.3": [
      "Guru membiasakan menghormati orang tua",
      "Guru membiasakan sikap jujur",
      "Guru menstimulasi anak menolong orang lain"
    ]
    // Lanjutkan sampai 26 butir sesuai isi PDF...
  };

  const formContainer = document.getElementById("formContainer");

  for (const [kode, indikatorList] of Object.entries(butirList)) {
    const section = document.createElement("div");
    section.className = "komponen";

    const label = document.createElement("label");
    label.innerText = `Butir ${kode}`;
    section.appendChild(label);

    const checkboxGroup = document.createElement("div");
    checkboxGroup.className = "checkbox-group";

    indikatorList.forEach((indikator, idx) => {
      const checkbox = document.createElement("input");
      checkbox.type = "checkbox";
      checkbox.id = `ind_${kode}_${idx}`;
      checkbox.name = `ind_${kode}`;
      checkbox.value = indikator;

      const cbLabel = document.createElement("label");
      cbLabel.htmlFor = checkbox.id;
      cbLabel.appendChild(checkbox);
      cbLabel.append(` ${indikator}`);
      checkboxGroup.appendChild(cbLabel);
    });
    section.appendChild(checkboxGroup);

    const textarea = document.createElement("textarea");
    textarea.id = `observasi_${kode}`;
    textarea.placeholder = "Tulis hasil observasi, wawancara, atau dokumen di sini...";
    section.appendChild(textarea);

    formContainer.appendChild(section);
  }

  function kirimData() {
    const nama = document.getElementById("nama_sekolah").value.trim();
    const npsn = document.getElementById("npsn").value.trim();

    if (!nama || !npsn) {
      alert("Mohon isi Nama Sekolah dan NPSN.");
      return;
    }

    const hasil = {};

    for (const kode of Object.keys(butirList)) {
      const tercentang = [];
      butirList[kode].forEach((indikator, idx) => {
        const cb = document.getElementById(`ind_${kode}_${idx}`);
        if (cb && cb.checked) tercentang.push(indikator);
      });
      const observasi = document.getElementById(`observasi_${kode}`).value.trim();
      hasil[kode] = {
        indikator: tercentang,
        observasi: observasi
      };
    }

    const data = {
      nama_sekolah: nama,
      npsn: npsn,
      jawaban: hasil
    };

    fetch("https://script.google.com/macros/s/AKfycbyMFsrlt99Kq7NXypkQhObpSXNX2KDgYOTxATNVao424q6Ug6T5hwhDdvucORZKXwXk/exec", {
      method: "POST",
      mode: "no-cors",
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    })
    .then(() => alert("âœ… Data berhasil dikirim ke spreadsheet!"))
    .catch(err => alert("Gagal mengirim: " + err));
  }
</script>

</body>
</html>
