from zipfile import ZipFile
from pathlib import Path

# Struktur file HTML dengan integrasi Google Apps Script (untuk Spreadsheet)
html_with_spreadsheet = """
<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Form Visitasi PAUD - PHA</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 900px; margin: auto; }
    input, textarea { width: 100%; padding: 10px; margin-bottom: 10px; border-radius: 5px; border: 1px solid #ccc; }
    button { padding: 10px 20px; font-size: 16px; background: #28a745; color: white; border: none; border-radius: 5px; }
    .section { background: #f8f9fa; padding: 15px; margin-top: 20px; border-radius: 8px; border: 1px solid #ddd; }
    h3 { color: #333; }
  </style>
</head>
<body>
  <h2>Form Visitasi PAUD (Terhubung Spreadsheet)</h2>

  <label>Nama Sekolah</label>
  <input type="text" id="nama_sekolah">

  <label>NPSN</label>
  <input type="text" id="npsn">

  <div id="formContainer"></div>

  <button onclick="kirimData()">Kirim</button>

  <script>
    const formData = {
      "1": {
        title: "Stimulasi Nilai Agama dan Moral",
        butir: {
          "1": "Guru menstimulasi anak untuk mempraktikkan pengalaman keagamaan",
          "2": "Guru menstimulasi anak beribadah sesuai agama/keyakinan",
          "3": "Guru membiasakan perilaku terpuji"
        }
      },
      "2": {
        title: "Stimulasi Fisik Motorik",
        butir: {
          "1": "Motorik kasar",
          "2": "Motorik halus",
          "3": "PHBS"
        }
      },
      "3": {
        title: "Stimulasi Kognitif",
        butir: {
          "1": "Pemecahan masalah",
          "2": "Berpikir logis, kritis dan kreatif",
          "3": "Berpikir simbolis"
        }
      },
      "4": {
        title: "Stimulasi Bahasa",
        butir: {
          "1": "Bahasa reseptif",
          "2": "Bahasa ekspresif",
          "3": "Keaksaraan"
        }
      },
      "5": {
        title: "Sosial Emosional",
        butir: {
          "1": "Mengendalikan diri",
          "2": "Perilaku prososial",
          "3": "Cinta tanah air",
          "4": "Budaya daerah"
        }
      },
      "6": {
        title: "Fasilitasi Pembelajaran",
        butir: {
          "1": "Lingkungan sebagai sumber belajar",
          "2": "Bermain sesuai minat",
          "3": "Pendekatan saintifik",
          "4": "Berkarya sesuai ide",
          "5": "Scaffolding dari guru"
        }
      },
      "7": {
        title: "Inovasi & PTK",
        butir: {
          "1": "Layanan inovatif",
          "2": "Pengembangan profesional guru"
        }
      },
      "8": {
        title: "Keamanan & Lingkungan",
        butir: {
          "1": "Prosedur keselamatan"
        }
      },
      "9": {
        title: "Dukungan Orangtua",
        butir: {
          "1": "Keterlibatan orang tua"
        }
      },
      "10": {
        title: "Perilaku Hidup Sehat",
        butir: {
          "1": "Membiasakan hidup sehat"
        }
      }
    };

    const container = document.getElementById("formContainer");
    for (let kom in formData) {
      const section = document.createElement("div");
      section.className = "section";
      section.innerHTML = `<h3>Komponen ${kom}: ${formData[kom].title}</h3>`;
      const butirData = formData[kom].butir;
      for (let i in butirData) {
        const kode = `${kom}.${i}`;
        section.innerHTML += `<label>${kode} - ${butirData[i]}</label>`;
        section.innerHTML += `<textarea id="jawaban_${kode}"></textarea>`;
      }
      container.appendChild(section);
    }

    function kirimData() {
      const nama = document.getElementById("nama_sekolah").value;
      const npsn = document.getElementById("npsn").value;
      const jawaban = {};

      for (let kom in formData) {
        for (let i in formData[kom].butir) {
          const kode = `${kom}.${i}`;
          jawaban[kode] = document.getElementById(`jawaban_${kode}`).value;
        }
      }

      const data = {
        nama_sekolah: nama,
        npsn: npsn,
        jawaban: jawaban
      };

      fetch("https://script.google.com/macros/s/YOUR_SCRIPT_ID/exec", {
        method: "POST",
        body: JSON.stringify(data),
        headers: { "Content-Type": "application/json" }
      })
      .then(response => response.text())
      .then(result => alert("Data berhasil dikirim!"))
      .catch(error => alert("Gagal mengirim: " + error));
    }
  </script>
</body>
</html>
"""

# Simpan file
html_dir = Path("/mnt/data/form-visitasi-paud-spreadsheet")
html_dir.mkdir(exist_ok=True)
index_file = html_dir / "index.html"
index_file.write_text(html_with_spreadsheet, encoding="utf-8")

# Zip file
zip_output = "/mnt/data/form-visitasi-paud-spreadsheet.zip"
with ZipFile(zip_output, "w") as zipf:
    zipf.write(index_file, arcname="index.html")

zip_output
