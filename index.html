<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Form Visitasi PAUD</title>
  <style>
    body { font-family: Arial, sans-serif; padding: 20px; max-width: 900px; margin: auto; }
    label { display: block; margin-top: 10px; font-weight: bold; }
    input, textarea {
      width: 100%; padding: 10px; margin-bottom: 10px;
      border: 1px solid #ccc; border-radius: 5px;
    }
    button {
      padding: 10px 20px; background: #28a745; color: white;
      border: none; border-radius: 5px; font-size: 16px;
    }
    button:hover { background: #218838; }
    .komponen { margin-top: 30px; background: #f9f9f9; padding: 15px; border-radius: 8px; }
  </style>
</head>
<body>

<h2>Form Visitasi PAUD</h2>

<label>Nama Sekolah</label>
<input type="text" id="nama_sekolah" placeholder="Contoh: PAUD Ceria" required>

<label>NPSN</label>
<input type="text" id="npsn" placeholder="Contoh: 12345678" required>

<div id="formContainer"></div>

<button onclick="kirimData()">Kirim</button>

<script>
  const butir = [
    "1.1","1.2","1.3","2.1","2.2","2.3",
    "3.1","3.2","3.3","4.1","4.2","4.3",
    "5.1","5.2","5.3","5.4","6.1","6.2","6.3","6.4","6.5",
    "7.1","7.2","8.1","9.1","10.1"
  ];

  const formContainer = document.getElementById("formContainer");
  butir.forEach(kode => {
    const label = document.createElement("label");
    label.innerText = `Butir ${kode}`;
    const textarea = document.createElement("textarea");
    textarea.id = `butir_${kode}`;
    textarea.placeholder = "Tulis observasi, wawancara, atau dokumen...";
    formContainer.appendChild(label);
    formContainer.appendChild(textarea);
  });

  function kirimData() {
    const nama = document.getElementById("nama_sekolah").value.trim();
    const npsn = document.getElementById("npsn").value.trim();

    if (!nama || !npsn) {
      alert("Mohon isi Nama Sekolah dan NPSN.");
      return;
    }

    const jawaban = {};
    butir.forEach(kode => {
      jawaban[kode] = document.getElementById(`butir_${kode}`).value.trim();
    });

    const data = {
      nama_sekolah: nama,
      npsn: npsn,
      jawaban: jawaban
    };

    fetch("https://script.google.com/macros/s/AKfycbyMFsrlt99Kq7NXypkQhObpSXNX2KDgYOTxATNVao424q6Ug6T5hwhDdvucORZKXwXk/exec", {
      method: "POST",
      mode: "no-cors", // untuk bypass error fetch dari GitHub Pages
      headers: { "Content-Type": "application/json" },
      body: JSON.stringify(data)
    })
    .then(() => alert("âœ… Data berhasil dikirim ke spreadsheet!"))
    .catch(err => alert("Gagal mengirim: " + err));
  }
</script>

</body>
</html>
